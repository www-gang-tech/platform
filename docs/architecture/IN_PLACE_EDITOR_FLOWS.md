# In-Place Editor - User Flows & Architecture

## User Flow Diagrams

### Current Studio Flow

```
START
  â”‚
  â”œâ”€ User visits /pages/manifesto
  â”‚  â””â”€ Reads content
  â”‚     â””â”€ Decides to edit
  â”‚        â”‚
  â”‚        â”œâ”€ Opens new tab/window
  â”‚        â”‚  â””â”€ Navigates to /studio
  â”‚        â”‚     â””â”€ Sees different interface (sidebar + editor panel)
  â”‚        â”‚        â”‚
  â”‚        â”‚        â”œâ”€ Clicks on sidebar to browse files
  â”‚        â”‚        â”‚  â””â”€ Finds "pages/manifesto.md"
  â”‚        â”‚        â”‚     â””â”€ Clicks to load
  â”‚        â”‚        â”‚        â”‚
  â”‚        â”‚        â”‚        â”œâ”€ Edits in WYSIWYG/Markdown
  â”‚        â”‚        â”‚        â”‚  â””â”€ Clicks "Publish"
  â”‚        â”‚        â”‚        â”‚     â””â”€ Content saved
  â”‚        â”‚        â”‚        â”‚        â”‚
  â”‚        â”‚        â”‚        â”‚        â”œâ”€ Switches back to original tab
  â”‚        â”‚        â”‚        â”‚        â”‚  â””â”€ Reloads page
  â”‚        â”‚        â”‚        â”‚        â”‚     â””â”€ Sees changes
  â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
END (11 steps, 2 context switches)
```

### In-Place Editor Flow

```
START
  â”‚
  â”œâ”€ User visits /pages/manifesto
  â”‚  â””â”€ Reads content
  â”‚     â””â”€ Decides to edit
  â”‚        â”‚
  â”‚        â”œâ”€ Clicks "Edit" button
  â”‚        â”‚  â””â”€ Editor loads in same page
  â”‚        â”‚     â””â”€ Content becomes editable
  â”‚        â”‚        â”‚
  â”‚        â”‚        â”œâ”€ Edits in WYSIWYG/Markdown
  â”‚        â”‚        â”‚  â””â”€ Clicks "Publish"
  â”‚        â”‚        â”‚     â””â”€ Validates & saves
  â”‚        â”‚        â”‚        â””â”€ Page reloads with changes
  â”‚        â”‚        â”‚           â”‚
END (8 steps, 0 context switches)
```

## Technical Architecture Diagrams

### System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GANG Platform                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Content    â”‚ â”‚   Build     â”‚ â”‚   Deploy    â”‚
      â”‚  (Markdown) â”‚ â”‚  (Python)   â”‚ â”‚ (Cloudflare)â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚
              â–¼                               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   Studio    â”‚                 â”‚  In-Place   â”‚
      â”‚   (Old)     â”‚                 â”‚   Editor    â”‚
      â”‚             â”‚                 â”‚   (New)     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Separate /studio                Edit in context
```

### In-Place Editor Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Published Page                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ /pages/manifesto                                         â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  [Header] [Navigation]                                   â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  <main id="content">                                     â”‚  â”‚
â”‚  â”‚    <!-- Page content here -->                            â”‚  â”‚
â”‚  â”‚  </main>                                                 â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  [Footer]                                                â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  {% if authenticated %}                                  â”‚  â”‚
â”‚  â”‚    <button onclick="activateEditor()">Edit</button>      â”‚  â”‚
â”‚  â”‚    <script src="/assets/editor-bundle.js" defer>         â”‚  â”‚
â”‚  â”‚  {% endif %}                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ User clicks "Edit"
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Edit Mode Active                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ â”‚  ğŸ“¤ Publish  ğŸ’¾ Save  âœ“ Check  âŒ Cancel         â”‚   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  [Header] [Navigation]                                   â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚ ToastUI Editor (WYSIWYG/Markdown)               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                   â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ # Manifesto                                      â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                   â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ Our manifesto content with **formatting**...     â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                   â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  [Footer]                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Click "Edit"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  editor-bundle.js                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ InPlaceEditor.activate()       â”‚  â”‚
â”‚  â”‚  - Store original HTML         â”‚  â”‚
â”‚  â”‚  - Fetch markdown from API     â”‚  â”‚
â”‚  â”‚  - Initialize ToastUI Editor  â”‚  â”‚
â”‚  â”‚  - Show toolbar                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 2. GET /api/content/pages/manifesto
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Studio Backend (Flask/Python)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ @app.route('/api/content/<>')  â”‚  â”‚
â”‚  â”‚  - Read content/pages/         â”‚  â”‚
â”‚  â”‚    manifesto.md                â”‚  â”‚
â”‚  â”‚  - Return markdown text        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 3. Return markdown
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser - Editor Active             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ToastUI Editor                 â”‚  â”‚
â”‚  â”‚  - Load markdown               â”‚  â”‚
â”‚  â”‚  - User edits content          â”‚  â”‚
â”‚  â”‚  - Click "Publish"             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 4. POST /api/validate-headings
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Studio Backend                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ validate_headings()            â”‚  â”‚
â”‚  â”‚  - Parse markdown              â”‚  â”‚
â”‚  â”‚  - Check WCAG compliance       â”‚  â”‚
â”‚  â”‚  - Return valid/errors         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 5. If valid, PUT /api/content/pages/manifesto
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Studio Backend                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ save_content()                 â”‚  â”‚
â”‚  â”‚  - Write to disk               â”‚  â”‚
â”‚  â”‚  - Git commit                  â”‚  â”‚
â”‚  â”‚  - Git push                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 6. Trigger GitHub Actions
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Actions                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ build-deploy.yml               â”‚  â”‚
â”‚  â”‚  - gang build                  â”‚  â”‚
â”‚  â”‚  - Lighthouse audit            â”‚  â”‚
â”‚  â”‚  - Deploy to Cloudflare        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ 7. Deploy complete
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Page reloads                   â”‚  â”‚
â”‚  â”‚  - Shows new content           â”‚  â”‚
â”‚  â”‚  - Edit mode exits             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## State Transitions

### Edit Mode State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VIEWING  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  (Read)   â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
      â”‚                             â”‚
      â”‚ Click "Edit"                â”‚
      â–¼                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  LOADING  â”‚                       â”‚
â”‚  (Fetch)  â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
      â”‚                             â”‚
      â”‚ Editor ready                â”‚
      â–¼                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  EDITING  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  (Active) â”‚            â”‚          â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚          â”‚
      â”‚                  â”‚          â”‚
      â”œâ”€ Save Draft â”€â”€â”€â”€â”€â”¤          â”‚
      â”‚                  â”‚          â”‚
      â”œâ”€ Validate â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
      â”‚                  â”‚          â”‚
      â”‚ Publish          â”‚          â”‚
      â–¼                  â”‚          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚          â”‚
â”‚VALIDATING â”‚            â”‚          â”‚
â”‚  (Check)  â”‚            â”‚          â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚          â”‚
      â”‚                  â”‚          â”‚
      â”œâ”€ Invalid â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
      â”‚                             â”‚
      â”‚ Valid                       â”‚
      â–¼                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  SAVING   â”‚                       â”‚
â”‚ (Commit)  â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
      â”‚                             â”‚
      â”‚ Deploy complete             â”‚
      â–¼                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚ RELOADING â”‚                       â”‚
â”‚  (Fresh)  â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
      â”‚                             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Architecture

### Editor Bundle Structure

```
editor-bundle.js
â”œâ”€â”€ InPlaceEditor (class)
â”‚   â”œâ”€â”€ constructor()
â”‚   â”‚   â””â”€â”€ Initialize state
â”‚   â”‚
â”‚   â”œâ”€â”€ activate()
â”‚   â”‚   â”œâ”€â”€ Store original HTML
â”‚   â”‚   â”œâ”€â”€ Fetch markdown from API
â”‚   â”‚   â”œâ”€â”€ Initialize ToastUI Editor
â”‚   â”‚   â””â”€â”€ Show floating toolbar
â”‚   â”‚
â”‚   â”œâ”€â”€ initEditor(markdown)
â”‚   â”‚   â””â”€â”€ Create ToastUI instance
â”‚   â”‚
â”‚   â”œâ”€â”€ validateHeadings()
â”‚   â”‚   â”œâ”€â”€ Get markdown from editor
â”‚   â”‚   â”œâ”€â”€ POST to /api/validate-headings
â”‚   â”‚   â””â”€â”€ Show validation modal if errors
â”‚   â”‚
â”‚   â”œâ”€â”€ publish()
â”‚   â”‚   â”œâ”€â”€ Validate headings
â”‚   â”‚   â””â”€â”€ If valid â†’ saveAndDeploy()
â”‚   â”‚
â”‚   â”œâ”€â”€ forcePublish()
â”‚   â”‚   â””â”€â”€ Save without validation (confirm first)
â”‚   â”‚
â”‚   â”œâ”€â”€ saveAndDeploy()
â”‚   â”‚   â”œâ”€â”€ PUT /api/content/{path}
â”‚   â”‚   â”œâ”€â”€ Wait for deploy
â”‚   â”‚   â””â”€â”€ Reload page
â”‚   â”‚
â”‚   â”œâ”€â”€ saveDraft()
â”‚   â”‚   â””â”€â”€ Save to localStorage
â”‚   â”‚
â”‚   â”œâ”€â”€ loadDraft()
â”‚   â”‚   â””â”€â”€ Restore from localStorage
â”‚   â”‚
â”‚   â”œâ”€â”€ cancel()
â”‚   â”‚   â”œâ”€â”€ Confirm discard
â”‚   â”‚   â””â”€â”€ Restore original HTML
â”‚   â”‚
â”‚   â”œâ”€â”€ showToolbar()
â”‚   â”‚   â””â”€â”€ Display floating controls
â”‚   â”‚
â”‚   â”œâ”€â”€ hideToolbar()
â”‚   â”‚   â””â”€â”€ Hide floating controls
â”‚   â”‚
â”‚   â””â”€â”€ showNotification(msg, type)
â”‚       â””â”€â”€ Toast message
â”‚
â””â”€â”€ Global exports
    â”œâ”€â”€ window.gangEditor = new InPlaceEditor()
    â””â”€â”€ window.activateEditor = () => gangEditor.activate()
```

### Backend API Structure

```
Studio Backend
â”œâ”€â”€ /api/content
â”‚   â”œâ”€â”€ GET /{category}/{slug}
â”‚   â”‚   â””â”€â”€ Return markdown source
â”‚   â”‚
â”‚   â””â”€â”€ PUT /{category}/{slug}
â”‚       â”œâ”€â”€ Validate auth
â”‚       â”œâ”€â”€ Write markdown to disk
â”‚       â”œâ”€â”€ Git commit
â”‚       â””â”€â”€ Git push (triggers deploy)
â”‚
â”œâ”€â”€ /api/validate-headings
â”‚   â””â”€â”€ POST
â”‚       â”œâ”€â”€ Parse markdown
â”‚       â”œâ”€â”€ Check heading hierarchy
â”‚       â””â”€â”€ Return {valid, errors, suggestions}
â”‚
â”œâ”€â”€ /api/build
â”‚   â””â”€â”€ POST
â”‚       â”œâ”€â”€ Commit changes
â”‚       â”œâ”€â”€ Push to GitHub
â”‚       â””â”€â”€ Trigger GitHub Actions
â”‚
â””â”€â”€ /api/auth/status
    â””â”€â”€ GET
        â””â”€â”€ Return {authenticated, user}
```

## Deployment Flow

```
Developer makes edit
        â”‚
        â–¼
Click "Publish"
        â”‚
        â”œâ”€â”€â”€ Validate headings (client)
        â”‚    â””â”€ If invalid â†’ Show errors
        â”‚       â””â”€ Fix or "Publish Anyway"
        â”‚
        â–¼
Save to API (PUT /api/content/{path})
        â”‚
        â–¼
Backend writes to disk
        â”‚
        â–¼
Git commit
        â”‚
        â–¼
Git push to GitHub
        â”‚
        â–¼
GitHub Actions triggered
        â”‚
        â”œâ”€â”€â”€ Run gang build
        â”‚    â””â”€ Parse markdown
        â”‚       â””â”€ Generate HTML
        â”‚          â””â”€ Copy assets
        â”‚
        â”œâ”€â”€â”€ Validate contracts
        â”‚    â””â”€ Check JSON-LD
        â”‚       â””â”€ Verify structure
        â”‚
        â”œâ”€â”€â”€ Lighthouse audit
        â”‚    â””â”€ Performance: 95+
        â”‚       â””â”€ Accessibility: 98+
        â”‚
        â”œâ”€â”€â”€ Axe a11y audit
        â”‚    â””â”€ Check WCAG violations
        â”‚
        â””â”€â”€â”€ Deploy to Cloudflare Pages
             â””â”€ Upload dist/
                â””â”€ Update DNS
                   â””â”€ Clear cache
                      â””â”€ LIVE! âœ…
```

## Mobile Experience

### Mobile Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /pages/manifesto        â”‚
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“¤  ğŸ’¾  âœ“  âŒ      â”‚ â”‚ â† Compact toolbar
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚  ToastUI Editor     â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚  Full width         â”‚ â”‚
â”‚ â”‚  editing area       â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â”‚                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ [âœï¸ Edit]               â”‚ â† Floating button
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Touch Optimizations

- **Toolbar buttons**: 44px min height (iOS guidelines)
- **Edit trigger**: Large touch target (48x48px)
- **Modal dialogs**: Full screen on mobile
- **Keyboard**: Push content up (not cover)

## Performance Timeline

```
t=0ms   â”‚ User clicks "Edit"
        â”‚
t=50ms  â”‚ Store original HTML
        â”‚ Show loading indicator
        â”‚
t=100ms â”‚ Fetch markdown from API
        â”‚
t=250ms â”‚ Markdown received
        â”‚ Parse and prepare
        â”‚
t=300ms â”‚ Initialize ToastUI Editor
        â”‚
t=450ms â”‚ Editor rendered
        â”‚ Show floating toolbar
        â”‚
t=500ms â”‚ âœ… Edit mode ready!
        â”‚ Focus in editor
        â”‚
        â”‚ ... user edits ...
        â”‚
        â”‚ User clicks "Publish"
        â”‚
t+0s    â”‚ Validate headings
        â”‚
t+0.2s  â”‚ Validation complete
        â”‚
t+0.3s  â”‚ Save to API
        â”‚
t+1s    â”‚ Git commit + push
        â”‚
t+2s    â”‚ GitHub Actions triggered
        â”‚
t+30s   â”‚ Build complete
        â”‚
t+45s   â”‚ Lighthouse audit done
        â”‚
t+60s   â”‚ âœ… Deployed!
        â”‚ Page reloads
```

## Error Handling Flow

```
User clicks "Publish"
        â”‚
        â–¼
Validate headings
        â”‚
        â”œâ”€ Valid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â””â”€ Invalid        â”‚
           â”‚              â”‚
           â–¼              â”‚
        Show modal        â”‚
        with errors       â”‚
           â”‚              â”‚
           â”œâ”€ Fix & retry â”‚
           â”‚              â”‚
           â””â”€ Publish     â”‚
              anyway      â”‚
              (confirm)   â”‚
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Save to API
        â”‚
        â”œâ”€ Success â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â””â”€ Error          â”‚
           â”‚              â”‚
           â–¼              â”‚
        Show error        â”‚
        "Try again"       â”‚
           â”‚              â”‚
           â””â”€ Retry â”€â”€â”€â”€â”€â”€â”¤
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Deploy triggered
        â”‚
        â”œâ”€ Success â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â””â”€ Error          â”‚
           â”‚              â”‚
           â–¼              â”‚
        Show deploy       â”‚
        error             â”‚
           â”‚              â”‚
           â””â”€ Manual      â”‚
              deploy      â”‚
              option      â”‚
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
âœ… Content live!
```

---

## Summary

The in-place editor transforms the editing experience from:

**Before**: Separate tool, different UI, context switching  
**After**: Native page feature, same context, seamless flow

All achieved with minimal code changes and maximum UX improvement!


